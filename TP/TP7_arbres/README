FIX MISTAKES POINTED OUT BY RIBEIRO.
avoid typedefs when possible.

READ BERNARD'S TP AND ADD IMPROVEMENTS

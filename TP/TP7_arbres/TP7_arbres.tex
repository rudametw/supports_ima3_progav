\RequirePackage[l2tabu, orthodox]{nag}

%\documentclass[a4paper]{article}
%\documentclass[final, pdftex, a4paper, 12pt, openbib, ]{article}
\documentclass[final, pdftex, a4paper, openbib, ]{article}
\usepackage[utf8]{inputenc}
\usepackage[francais]{babel}
%\usepackage{lmodern}
\usepackage[T1]{fontenc}
%\usepackage{graphicx}
\usepackage{alltt}
\usepackage{float}
%\usepackage{times}
%\usepackage{a4wide}
\usepackage{upquote,textcomp}
\usepackage{geometry}
%\usepackage{hyperref}
\usepackage[
pdftex,
final,                      % if you do    want to have clickable-colorful links
pdfstartview = FitV,
linktocpage  = false,       % ToC, LoF, LoT place hyperlink on page number, rather than entry text
breaklinks   = true,        % so long urls are correctly broken across lines
% pagebackref  = false,     % add page number in bibliography and link to position in document where cited
]{hyperref}
\usepackage{mathtools}
\geometry{a4paper, portrait, margin=2cm}
%\addtolength{\textheight}{2 cm}
%\addtolength{\oddsidemargin}{-1cm}
%\addtolength{\topmargin}{-1cm}
%\addtolength{\textwidth}{1 cm}

%Good solution for monospaces
%\usepackage{pxfonts} % Or palatino or mathpazo, changes all fonts to something sans
%\usepackage{eulervm} % only changes math fonts, i checked
%\usepackage[ttdefault=true]{AnonymousPro} %Only changes tt fonts
% WHICH ONE TO CHOOSE?
\usepackage{pslatex}
%\usepackage[ttdefault=true]{AnonymousPro} %Only changes tt fonts
% \usepackage[varg, cmintegrals, cmbraces, ]{newtxtext,newtxmath} % libertine, uprightGreek (U.S.) or slantedGreek (ISO), 
% \usepackage{tgtermes}
% \usepackage{txfonts}
% \usepackage{mathptmx}
% \usepackage[scaled=.90]{helvet}
% \usepackage{courier}
% \usepackage{textcomp}     % required for special glyphs
% \usepackage{bm}   


\usepackage{caption}
\captionsetup[figure]{labelformat=empty}% redefines the caption setup of the figures environment in the beamer class.

%Inconsoloata, a little too light.
%\usepackage{inconsolata}
%\renewcommand{\ttdefault}{Consolas}
%\usepackage{fontspec} %Doesn't work with pdflatex
%\setmonofont{Consolas}



%\renewcommand*\familydefault{\ttdefault} %% Only if the base font of the document is to be typewriter style

%\newcommand\Fontvi{\fontsize{6}{7.2}\selectfont}

%Make tabularx center cells vertically
%\def\tabularxcolumn#1{m{#1}}
%\renewcommand{\tabularxcolumn}[1]{>{\small}m{#1}}

%%Syntax hilighting
%\usepackage{fancyvrb}
\usepackage{minted}
%\usepackage[newfloat]{minted}
\usemintedstyle{borland}
%\usepackage{etoolbox}
%\AtBeginEnvironment{minted}{\singlespacing%
%	\fontsize{14}{14}\selectfont}
%\newminted{java}{fontsize=\footnotesize}
\usepackage{caption}

%\usepackage{multicol}
%\usepackage{vwcol}
%\usepackage{lipsum}
%\usepackage{microtype}
%\setlength{\columnseprule}{0.4pt}
%\renewcommand{\columnseprulecolor}{\color{red}}
\newcommand{\BAD}[1]{{\color{red}#1}}
\newcommand{\GOOD}[1]{{\color{darkgreen}#1}}


\usepackage{graphicx}
\usepackage{colortbl,array}
\usepackage{tabularx}
\definecolor{warningbackground}{RGB}{252,226,158}

\newcommand{\alertwarningbox}[1]{
    \centering
    \begin{tabularx}{0.9\linewidth}{
        >{\columncolor{warningbackground}}c
        >{\columncolor{warningbackground}}X}
        \raisebox{\dimexpr2\baselineskip-\height}
        {\includegraphics[scale=0.8]{attention.pdf}}&
        \raisebox{\tabcolsep}{\strut}#1\raisebox{-\tabcolsep}{\strut}
    \end{tabularx}
}


\usepackage{xcolor}

%\definecolor{infobackground}{RGB}{217,237,247}
%\definecolor{infoforeground}{RGB}{58,135,173}
%\definecolor{infoborder}{RGB}{188,232,241}

\definecolor{infobackground}{RGB}{217,237,247}
\definecolor{infoforeground}{RGB}{30,50,70}
\definecolor{infoborder}{RGB}{30,50,70}

\definecolor{infobackground}{RGB}{217,237,247}
\definecolor{infoforeground}{RGB}{30, 80, 150}
\definecolor{infoborder}{RGB}{47, 87, 232}


\usepackage{environ}
\usepackage{tikz}
\usetikzlibrary{fit,backgrounds,calc}

\NewEnviron{alertinfo}[1]
{
\begin{center}
    \begin{tikzpicture}
    \node[inner sep=0pt,
          draw=infoborder,
          line width=1pt,
          fill=infobackground] (box) {\parbox[t]{0.99\textwidth}
        {%
            \begin{minipage}{.12\textwidth}
                \centering\tikz[scale=3]
                \node[scale=1]
                {
%                    \includegraphics[scale=0.25]{\images/information.pdf}
                    \includegraphics[scale=0.15]{\images/information.pdf}                    
                };
            \end{minipage}%
           \begin{minipage}{.86\textwidth}
%                \vskip 10pt
                \textbf{\textcolor{infoforeground}{\large #1}}\par\smallskip
                \textcolor{infoforeground}{\large \BODY}
                \par\smallskip
                \par\smallskip
            \end{minipage}\hfill
        }%
    };
    \end{tikzpicture}
\end{center}
}

\usepackage{titling}
\usepackage{soul}

\definecolor{Light}{gray}{.93}
\sethlcolor{Light}
\let\OldTexttt\texttt	
\renewcommand{\texttt}[1]{\OldTexttt{\hl{#1}}}

\newcommand{\codes}{../codes/TP7}
\newcommand{\images}{../images}

%\title{GBIAAL 4$^{\mbox{\`eme}}$ année \\ Devoir Surveillé --- Base de données \\ 13 janvier 2016  \\ 1 heure}
\title{IMA 3$^{\mbox{\`eme}}$ année\\ Programmation Avancé
	%\\TP1 Structures, Listes contiguës, Redirections}
}
\author{\huge \textbf{TP7 Arbres d'entiers}}
\setlength{\parindent}{0pt}
\pagestyle{empty}
\date{}


\begin{document}
%\vspace{-13cm}
%\posttitle{\par\end{center}}
\setlength{\droptitle}{-90pt}
\maketitle
%\thispagestyle{empty}

%\section{Schéma conceptuel}
\vspace{-2.1cm}
\section{Objectifs}

\begin{itemize}
	\item Savoir créer et utiliser une bibliothèque d'arbres d'entiers
	\item Savoir coder quelques algorithmes de base sur les arbres
\end{itemize}

%\paragraph{Contexte et préparation : } Avant de commencer, récupérez le fichier \url{~wrudamet/public/IMA3/TP6/tp6_gdb.tgz} à la ligne de commande. Désarchivez\footnote{Vous pouvez utiliser la commande \texttt{tar} pour décompresser et désarchivez ce fichier} le dans votre répertoire de \textit{Programmation Avancé} (toujours à la ligne de commande !).

\paragraph{Préparation : } Avant de commencer, copier le répertoire \url{~wrudamet/public/IMA3/TP7/} qui contient :

\begin{itemize}
	\item Les fichiers \texttt{trees.c} et \texttt{trees.h}, contenant des fonctions de base de traitement d'arbres
	\item Un fichier \texttt{main.c} utilisant ces fonctions
	\item Un sous-répertoire \texttt{samples/} qui contient des fichiers de données \texttt{.txt} et des fichiers \texttt{.dot} et \texttt{.pdf} qui permettent de visualiser les arbres correspondant à ces données (section 2).
	\item Un fichier \texttt{tree2pdf.c} qui contient un deuxième main.
\end{itemize}


\section{Fonctions de base dans les ABR}
Dans cette première partie, il vous est demandé d'implémenter les fonctions définis dans \texttt{tree.h} en utilisant le \texttt{main} fourni pour tester (corriger tous les \textit{warnings} à la compilation et utilisez \textit{valgrind}) :

\begin{enumerate}
	\item \mintinline{C}{cons_tree(...)} qui construit un ABR \textit{(fait en cours)}.
	%Pour cette fonction, on s'inspirera de la fonction \texttt{charge\_fichier} donnée dans le \textit{TP6 Bibliothèque de listes chaînées de chaînes}
	%On ajoute des entiers et non des chaînes.
	
	\item \mintinline{C}{mk_empty_tree(...)}, \mintinline{C}{is_empty(...)} et \mintinline{C}{is_leaf(...)}, tous des fonctions auxiliaires. \textit{(Fait en cours)}
	
	\item \mintinline{C}{add(...)} qui ajout un élément dans un ABR (arbre binaire de recherche, donc \textbf{ordonné} !). \textit{(Fait en cours)}
	
	\item \mintinline{C}{print_tree(...)} qui imprime un ABR par parcours récursif, en ordre ascendant (\textit{infixe}).
	
	Vérifier que la fonction de parcours précédente donne la même suite de valeurs pour les trois fichiers \texttt{unspecified.txt}, \texttt{balanced.txt}, \texttt{degenerated.txt} alors que ce sont des arbres différents (voir les dessins dans le répertoire \texttt{samples/})
	
	\item \mintinline{C}{load_tree(...)} qui construit un arbre d'entiers à partir d'un fichier.
	\item \mintinline{C}{free_tree(...)} qui libère la mémoire utilisé par un arbre binaire.
	
	\item Écrire une fonction d'impression \mintinline{C}{print_rec_edges(...)} qui imprime les couples \textit{(père =L=> fils)} pour les fils gauches, et \textit{(père =R=> fils)} pour les fils droits, d'un arbre donné. Ne pas imprimer les sous-arbres vides.
	À part la flèche \textit{=L/R=>}, l'impression donne des arbres correspondant aux fichiers .dot fournis dans le répertoire \texttt{samples/}
	
	\item Archiver le fichier \texttt{trees.o} dans une bibliothèque \texttt{libtrees.a} (commande \texttt{ar}).
\end{enumerate}


\section{Impression des arbres sous forme graphique}
Les fichiers \texttt{.pdf} ont été générés à partir des fichiers \texttt{.dot} (fournis dans \texttt{samples/}).
Le format \texttt{.dot} est un format de représentation textuelle simple d'arbres\footnote{Et plus généralement de graphes exploitables par des logiciels tels que \url{http://www.graphviz.org}}.
Visualisez le format de ces fichiers dans votre éditeur de texte préféré ou par la commande \texttt{less}\footnote{digraph signifie \textit{directed graph}, les arbres en font partie du fait de leur orientation \texttt{pere->fils}}.
À partir de ce format .dot, la commande \texttt{dot} permet de générer une version visualisable (.pdf, .png, \ldots) comme suit (en pdf par exemple) :

\begin{minted}[mathescape=true,escapeinside=||,tabsize=4,
%fontsize=\footnotesize,
]{bash}
				dot -Tpdf samples/balanced.dot -o samples/balanced.pdf
\end{minted}

L'objectif est alors de générer de tels fichiers pour des arbres construits à partir de fichiers de données (tels que ceux fournis dans \texttt{samples/*.txt}).
					
\paragraph{Préparation :} Un fichier \texttt{tree2pdf.c} plus conséquent est fourni qui :
\begin{enumerate}
	\item Génère, par appel à la fonction \texttt{generate\_dot}, les fichiers \texttt{.dot} correspondants aux fichiers de données dont les noms ont été passés en paramètre (e.g. à partir de \texttt{samples/balanced.txt} on génère \texttt{samples/balanced.dot}).
	\item Transforme ces fichiers \texttt{.dot} en \texttt{.pdf} par appel système à la commande \texttt{dot}.
\end{enumerate}

\paragraph{Travail à faire :}
\begin{enumerate}
	\item Programmer la fonction \texttt{recursive\_dot} qui traite le cas général
	\item Tester ensuite par la commande : \texttt{./tree2pdf samples/*.txt}
Vous devez retrouver les fichiers \texttt{.dot} et \texttt{.pdf}.
\end{enumerate}

%\section{Annexes}
%\vspace{-0.5cm}
\pagebreak
\section{Annexes}
%\vspace{-0.5cm}
\begin{figure}[!h]
	\begin{minipage}[c]{0.69\textwidth}
		\centering
		\inputminted[
		%frame=lines,
		%framesep=2.5mm,
		%baselinestretch=0.8,
		fontsize=\small,
		linenos,
		tabsize=2,
		breaklines,
		xleftmargin=-5pt,
		numbersep=7pt,		
		%firstline=14,lastline=28
		%bgcolor=light-gray
		]
%		{c}{\codes/accompttp.c}
%		\caption{\texttt{accompttp.c}}
		{c}{\codes/trees.h}
		\caption{\texttt{trees.h}}

	\end{minipage}
	\begin{minipage}[c]{0.36\textwidth}
		\centering
		\inputminted[
		%frame=lines,
		%framesep=2.5mm,
		%baselinestretch=0.8,
		fontsize=\small,
%		linenos,
		tabsize=2,
		breaklines,
		xleftmargin=10pt,
		numbersep=7pt,		
		%firstline=14,lastline=28
		%bgcolor=light-gray
		]
%		{c}{\codes/accompttp.c}
%		\caption{\texttt{accompttp.c}}
		{c}{\codes/samples/balanced.txt}
		\vspace{-0.7cm}
		\caption{\texttt{samples/balanced.txt}}

		\vspace{0.2cm}

		\centering
		\inputminted[
		%frame=lines,
		%framesep=2.5mm,
		%baselinestretch=0.8,
		fontsize=\small,
		linenos,
		tabsize=4,
		breaklines,
		xleftmargin=60pt,
		numbersep=7pt,
%		breaksymbolleft=,
		%firstline=14,lastline=28
		%bgcolor=light-gray
		]
%		{c}{\codes/listechaines.h}
%		\caption{\texttt{listechaines.h}}
		{c}{\codes/samples/balanced.dot}
		\vspace{-0.7cm}
		\caption{\texttt{samples/balanced.dot}}
		
		\vspace{2cm}
		
				\centering
				\inputminted[
				%frame=lines,
				%framesep=2.5mm,
				%baselinestretch=0.8,
				fontsize=\small,
		%		linenos,
				tabsize=2,
				breaklines,
				xleftmargin=10pt,
				numbersep=7pt,		
				%firstline=14,lastline=28
				%bgcolor=light-gray
				]
		%		{c}{\codes/accompttp.c}
		%		\caption{\texttt{accompttp.c}}
				{c}{\codes/samples/unspecified.txt}
				\vspace{-0.7cm}
				\caption{\texttt{samples/unspecified.txt}}
		
		\vspace{0.2cm}
		
				\centering
				\inputminted[
				%frame=lines,
				%framesep=2.5mm,
				%baselinestretch=0.8,
				fontsize=\small,
				linenos,
				tabsize=4,
				breaklines,
				xleftmargin=60pt,
				numbersep=7pt,
		%		breaksymbolleft=,
				%firstline=14,lastline=28
				%bgcolor=light-gray
				]
		%		{c}{\codes/listechaines.h}
		%		\caption{\texttt{listechaines.h}}
				{c}{\codes/samples/unspecified.dot}
				\vspace{-0.7cm}
				\caption{\texttt{samples/unspecified.dot}}
		
	\end{minipage}
\end{figure}
%
%\begin{figure}[!h]
%	\begin{minipage}[c]{0.9\textwidth}
%		\centering
%		\inputminted[
%		%frame=lines,
%		%framesep=2.5mm,
%		%baselinestretch=0.8,
%		fontsize=\small,
%		linenos,
%		tabsize=2,
%		breaklines,
%		xleftmargin=20pt,
%		numbersep=7pt,		
%		%firstline=14,lastline=28
%		%bgcolor=light-gray
%		]
%%		{c}{\codes/accompttp.c}
%%		\caption{\texttt{accompttp.c}}
%		{c}{\codes/samples/balanced.txt}
%		\caption{\texttt{samples/balanced.txt}}
%
%	\end{minipage}
%	\hspace{0.15cm}
%	\vrule{}
%	\hspace{0.3cm}
%	\begin{minipage}[c]{0.75\textwidth}
%%		\centering
%		\inputminted[
%		%frame=lines,
%		%framesep=2.5mm,
%		%baselinestretch=0.8,
%		fontsize=\small,
%		linenos,
%		tabsize=4,
%		breaklines,
%		xleftmargin=4pt,
%		numbersep=7pt,
%%		breaksymbolleft=,
%		%firstline=14,lastline=28
%		%bgcolor=light-gray
%		]
%%		{c}{\codes/listechaines.h}
%%		\caption{\texttt{listechaines.h}}
%		{c}{\codes/samples/balanced.dot}
%		\caption{\texttt{samples/balanced.dot}}
%	\end{minipage}
%\end{figure}
%


\end{document}



\end{document}